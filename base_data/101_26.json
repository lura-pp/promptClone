{
    "title": "Create big Terraform modules for provisioning AWS ECS Service Module",
    "original_prompt": "Please develop a Terraform module named \"ecs_app\" to provision an AWS ECS Service. As you work on this task, I will sequentially provide information about the following features:\n\n1. ECS Service\n2. Task Definition Configuration\n3. Autoscaling policies\n4. Target group registration\n\nI will tell you once I've finished providing details for each feature. When presenting your answer, arrange the output resources in groups of up to 10. Request my confirmation before advancing to the next group. Your final response should only contain the completed Terraform module without additional explanations or questions.",
    "split_prompt": "This is a prompt description:```json\n{\n    \"spliting prompt\": {\n        \"module_name\": [\n            \"ecs_app\"\n        ],\n        \"features\": [\n            \"ECS Service\",\n            \"Task Definition Configuration\",\n            \"Autoscaling policies\",\n            \"Target group registration\"\n        ],\n        \"output_format\": [\n            \"grouped_resources\",\n            \"up_to_10_resources\",\n            \"request_confirmation\"\n        ],\n        \"final_response\": [\n            \"completed_Terraform_module\",\n            \"no_additional_explanations\",\n            \"no_questions\"\n        ]\n    }\n}\n```",
    "input1": " Please provide the details for the ECS Service, including the desired number of tasks, service type (Fargate or EC2), and any specific networking configurations such as VPC and subnets.\n\n",
    "input2": " I would like to specify the Task Definition Configuration next. Please include the container image, CPU and memory requirements, environment variables, and any IAM roles needed for the task execution.",
    "input1_ans": [
        "```hcl\nvariable \"service_name\" {\n  description = \"The name of the ECS service\"\n  type        = string\n}\n\nvariable \"desired_count\" {\n  description = \"The desired number of tasks\"\n  type        = number\n}\n\nvariable \"launch_type\" {\n  description = \"The launch type for the ECS service (FARGATE or EC2)\"\n  type        = string\n}\n\nvariable \"vpc_id\" {\n  description = \"The VPC ID where the ECS service will be deployed\"\n  type        = string\n}\n\nvariable \"subnet_ids\" {\n  description = \"A list of subnet IDs for the ECS service\"\n  type        = list(string)\n}\n\nresource \"aws_ecs_service\" \"ecs_service\" {\n  name            = var.service_name\n  cluster         = aws_ecs_cluster.ecs_cluster.id\n  task_definition = aws_ecs_task_definition.task_definition.arn\n  desired_count   = var.desired_count\n  launch_type     = var.launch_type\n\n  network_configuration {\n    subnets          = var.subnet_ids\n    assign_public_ip = \"ENABLED\"\n  }\n\n  depends_on = [aws_ecs_task_definition.task_definition]\n}\n```",
        "```json\n{\n    \"ECS_Service\": {\n        \"desired_tasks\": 3,\n        \"service_type\": \"Fargate\",\n        \"network_configuration\": {\n            \"vpc_id\": \"vpc-12345678\",\n            \"subnets\": [\n                \"subnet-12345678\",\n                \"subnet-87654321\"\n            ],\n            \"security_groups\": [\n                \"sg-12345678\"\n            ]\n        }\n    }\n}\n```"
    ],
    "input2_ans": [
        "```hcl\nvariable \"container_image\" {\n  description = \"The container image to use for the task.\"\n  type        = string\n}\n\nvariable \"cpu\" {\n  description = \"The number of CPU units to allocate to the task.\"\n  type        = number\n}\n\nvariable \"memory\" {\n  description = \"The amount of memory (in MiB) to allocate to the task.\"\n  type        = number\n}\n\nvariable \"environment\" {\n  description = \"A map of environment variables to set in the container.\"\n  type        = map(string)\n}\n\nvariable \"task_execution_role_arn\" {\n  description = \"The ARN of the IAM role that the task can assume.\"\n  type        = string\n}\n\nresource \"aws_ecs_task_definition\" \"app\" {\n  family                   = \"${var.name}-task\"\n  execution_role_arn      = var.task_execution_role_arn\n  network_mode             = \"awsvpc\"\n  requires_compatibilities = [\"FARGATE\"]\n  cpu                      = var.cpu\n  memory                   = var.memory\n  container_definitions    = jsonencode([{\n    name      = \"${var.name}-container\"\n    image     = var.container_image\n    cpu       = var.cpu\n    memory    = var.memory\n    essential = true\n    environment = [\n      for key, value in var.environment : {\n        name  = key\n        value = value\n      }\n    ]\n  }])\n}\n```",
        "```json\n{\n    \"TaskDefinitionConfiguration\": {\n        \"container_image\": \"your-container-image:latest\",\n        \"cpu\": \"256\",\n        \"memory\": \"512\",\n        \"environment_variables\": {\n            \"ENV_VAR_1\": \"value1\",\n            \"ENV_VAR_2\": \"value2\"\n        },\n        \"iam_role\": \"arn:aws:iam::your-account-id:role/your-task-execution-role\"\n    }\n}\n```"
    ]
}